\newcommand{\epsstep}{\left(e^{-i \hat{H} \epsilon}\right)}

\section{Preliminaries}
\label{sec:preliminaries-1}

In this lecture we introduce Path Integrals in the context of
QM. Despite the simpler setting (QM compared to QFT), all the
important features of Path Integrals will be discussed. We consider a
point particle in one-dimension, and denote by $\hat{Q}$ the position
operator, and by $\ket{q}$ the eigenstate corresponding to the eigenvalue
$q$:
\begin{equation}
  \label{eq:QEigen}
  \hat{Q} \ket{q} = q \ket{q}\, .
\end{equation}
The completeness condition for the states $\ket{q}$ is
\begin{equation}
  \label{eq:qComplete}
  \int dq\, \ket{q}\bra{q} = 1\, .
\end{equation}
The aim of this section is to find an expression for the quantum
amplitude $\braket{q't'}{qt}$ for a system in state $\ket{q}$ at time
$t$ to evolve in state $\ket{q'}$ at time $t'$,
\begin{equation}
  \label{eq:AmplitudeDef}
  \braket{q't'}{qt} = \langle q' | e^{-i \hat{H} (t'-t)}|q\rangle\, ,
\end{equation}
where $\hat{H}$ is the Hamiltonian of the system. 

Alternatively, we can think of $\ket{q,t}$ as the eigenvector of the 
position operator in the Heisenberg representation, 
\begin{align}
  \label{eq:QHeisenberg}
  \hat{Q}_H(t) = e^{i \hat{H} t} \hat{Q} e^{-i \hat{H}t}\, .
\end{align}
Then, letting 
\begin{align}
  \label{eq:HeisenbergEigenvect}
  \ket{q,t} = e^{i \hat{H}t} \ket{q}\, ,
\end{align}
we can easily check that
\begin{align}
  \label{eq:HeisenbergCheck}
  \hat{Q}_H(t) \ket{q,t} = q \ket{q,t}\, ,
\end{align}
and $\braket{q't'}{qt}$ reproduces Eq.~\eqref{eq:AmplitudeDef}.

\section{Setting Up the Path Integral}
\label{sec:setting-up-path}

In order to proceed with the calculation, let us define $T=t'-t$ to be
the size of the time interval, and $\epsilon=T/n$, where $n$ is an
integer. Then 
\begin{align}
  t_0 &= t \\
  t_k &= t_0 + k \epsilon, \quad \text{for}\ k=1, \ldots, n-1 \\
  t_n &= t + n \epsilon = t'\, .
\end{align}
\begin{align}
  \langle q' | e^{-i \hat{H} (t'-t)}|q\rangle &= 
                 \langle q' | e^{-i \hat{H} T} | q\rangle \\
               &= \langle q' | \left(e^{-i \hat{H} \epsilon}\right)
                 \ldots \left(e^{-i \hat{H} \epsilon}\right) |
                 q\rangle\, ,
\end{align}
where the expression in the second line contains $n$ factors. 

Inserting the completeness relation $n-1$ times,
\begin{align}
  \label{eq:AmplitudeStepOne}
  \braket{q't'}{qt} = \int \left(\prod_{k=1}^{n-1}dq_k\right)\,
  \langle q' | \left(e^{-i \hat{H} \epsilon}\right) |q_{n-1}\rangle
  \langle q_{n-1} | \left(e^{-i \hat{H} \epsilon}\right) |
  q_{n-2}\rangle \ldots \langle q_1 | \left(e^{-i \hat{H}
  \epsilon}\right) | q\rangle\, .
\end{align}
For small $\epsilon$ we can expand the exponential to first order and
evaluate the matrix elements:
\begin{align}
  e^{-i \hat{H} \epsilon} &= 1 - i \hat{H} \epsilon + O(\epsilon^2)\\
\hat{H} &= \frac12 \hat{P}^2 + V(\hat{Q})\, ,
\end{align}
From the potential energy we get
\begin{align}
  \langle q_k | V(\hat{Q}) | q_{k-1}\rangle &= V(q_{k-1}) \langle q_k
                                              | q_{k-1} \rangle \\
                                            &= V\left(\frac{q_k +
                                              q_{k-1}}{2}\right)
                                              \delta(q_k-q_{k-1}) \\
                                            & = \int \frac{dp}{2\pi} V\left(\frac{q_k +
                                              q_{k-1}}{2}\right) 
                                              e^{ip (q_k-q_{k-1})}
\end{align}
In order to evaluate the contribution of the kinetic term, we
introduce eigenstates of the momentum operator $\ket{p}$
\begin{align}
  \hat{P} \ket{p} = p \ket{p} \\
  \braket{q}{p} = e^{ipq}\, ,
\end{align}
and use the completeness of the states $\ket{p}$:
\begin{align}
  \langle q_k | \hat{P}^2 | q_{k-1}\rangle = 
  \int \frac{dp_k}{2\pi}\, p^2 e^{ip_k(q_k-q_{k-1})}\, .
\end{align}
Hence
\begin{align}
  \label{eq:EpsStepBraKet}
  \langle q_k | e^{-i\hat{H}\epsilon} | q_{k-1}\rangle = 
  \int \frac{dp_k}{2\pi}\, \exp\left\{i\epsilon \left[
  p_k \frac{q_k-q_{k-1}}{\epsilon} - H\left(p_k,\tilde{q}_k\right)
  \right]
  \right\} + O(\epsilon^2)\, ,
\end{align}
where $\tilde{q}_k=\frac{q_k-q_{k-1}}{2}$. Therefore
\begin{align}
  \braket{q't'}{qt} =& \lim_{n\to\infty} \int 
  \left(\prod_{k=1}^{n-1}dq_k\right)\, 
  \left(\prod_{j=1}^{n} \frac{dp_j}{2\pi}\right)\, \times \nonumber\\
  \label{eq:DiscretePhaseSpaceIntegral}
  &\times \exp \left\{
    i\epsilon \sum_{m=1}^{n} \left[
    p_m \frac{q_m-q_{m-1}}{\epsilon} - H\left(p_m, 
    \tilde{q}_m \right)
    \right]
    \right\}\, ,
\end{align}
where $q_0 = q$, and $q_n = q'$. The limit above defines the {\em
  path integral} evaluation of the quantum amplitude, which we denote 
\begin{align}
  \label{eq:PathIntDefZero}
  \braket{q't'}{qt} = 
  \int_{q,q'} \mathcal{D}q \mathcal{D}p \exp \left\{
  i \int_t^{t'} d\tau\, \left[
  p \dot{q} - H(p,q)
  \right]
  \right\}\, .
\end{align}

It is essential to remark at this stage that we have rewritten
a quantum amplitude as an infinite-dimensional integral. On the LHS
of the equation above we have the scalar product of two states in 
the Hilbert space of quantum states of the theory. On the RHS we 
have expressed this scalar product as the result of an integral. 
In the expression on the RHS there are no physical states, no 
operators; just integration variables. Note that we added the suffix
$q,q'$ to the integral sign, in order to keep track of the value of 
the position variables at the boundaries of the time interval. 

\section{Quadratic P dependence}
\label{sec:quadr-kinet-term}

For hamiltonians like the one above, \ie hamiltonians that are only
quadratic in the momentum $\hat{P}$, the expression above can be
simplified by performing the integral over the momenta $p_j$:
\begin{align}
  \int \frac{dp_k}{2\pi}\, \exp\left\{
  i\epsilon\left[
  p_k \left(\frac{q_k-q_{k-1}}{\epsilon}\right) - \frac12 p_k^2
  \right]
  \right\} = \left(2\pi i \epsilon\right)^{-1/2}\,
  \exp\left\{i\epsilon
  \frac12\left(\frac{q_k-q_{k-1}}{\epsilon}\right)^2\right\}\, .
\end{align}
Using this result, we can rewrite the path integral in
\Eqref{eq:PathIntDefZero} as
\begin{align}
  \label{eq:PathIntDefOne}
  \braket{q't'}{qt} = \lim_{n\to\infty}
  \left(2\pi i \epsilon\right)^{-n/2}\,
  \int \prod_{k=1}^{n-1}dq_k\, 
  \exp \left\{
  i \epsilon \sum_{m=1}^{n}
  \, \left[
  \frac12 \left(\frac{q_m-q_{m-1}}{\epsilon}\right)^2
  -V\left(\frac{q_m+q_{m-1}}{2}\right)
  \right]
  \right\}\, .
\end{align}
Assuming that the limit exists, we have obtained the definition of the
path integral as an integral over the position of the system only: 
\begin{align}
  \label{eq:PathIntDef}
  \braket{q't'}{qt} = 
  \int_{q,q'} \mathcal{D}q \exp \left\{
  i \int_t^{t'} d\tau\,  \mathcal{L}(q,\dot{q})
  \right\}\, ,
\end{align}
where $\mathcal{L}$ is the lagrangian of the system. Note that the
suffix of the integral keeps track of the initial- and final-state
configurations $q$ and $q'$. 

\section{Correlators}
\label{sec:correlators}

We are now going to work out expressions for the matrix element of the
position operator inbetween the initial and final state considered
above. 

\subsection{One-point Function}
\label{sec:one-point-function}

The first example that we are going to consider is the matrix element
\begin{align}
  \label{eq:OnePtDef}
  \langle q't' | \hat{Q}_H(\bar{t}) | q t\rangle = 
  \langle q' | e^{-i \hat{H}(t'-\bar{t})} \hat{Q} e^{-i \hat{H}(\bar{t}-t)}
  | q\rangle\, ,
\end{align}
where we assume $t<\bar{t}<t'$, and we have used
\begin{equation}
  \label{eq:HeisenOpEvol}
  \hat{Q}_H(t) = e^{i\hat{H} t} \hat{Q} e^{-i\hat{H} t}\, .
\end{equation}
Proceeding as we did in the previous section, we can write
\begin{align}
  \label{eq:CorrOne}
  \langle q't' | \hat{Q}_H(\bar{t}) | q t\rangle = 
  \bra{q'} \epsstep \ldots \epsstep \hat{Q} \epsstep \ldots
  \epsstep \ket{q}\, ,
\end{align}
where we assumed that $\bar{t}=t_{\bar k}$, and the first and second ellipses
denote respectively $(n-k)$, and $k$ factors of $\epsstep$. Performing
the same manipulations as before we obtain
\begin{align}
  \langle q't' | \hat{Q}_H(\bar{t}) | q t\rangle =& 
  \lim_{n\to\infty} \int 
  \left(\prod_{k=1}^{n-1}dq_k\right) \, 
  \left(\prod_{k=1}^{n} \frac{dp_k}{2\pi}\right)\, q_{\bar k} \times \\
  &\times \exp \left\{
    i\epsilon \sum_{m=1}^{n} \left[
    p_m \frac{q_m-q_{m-1}}{\epsilon} - H\left(p_m, 
    \frac{q_m+q_{m-1}}{2}\right)
    \right]
    \right\}\, .
\end{align}
Note that now there is an extra factor of $q_{\bar k}$ in the integrand,
corresponding to the insertion of the operator $\hat{Q}_H(\bar{t})$. The
limit above  is denoted
\begin{align}
  \langle q't' | \hat{Q}_H(\bar{t}) | q t\rangle &= 
  \int \mathcal{D}q \mathcal{D}p \, q(\bar{t}) 
  \exp \left\{
  i \int_t^{t'} d\tau\, \left[
  p \dot{q} - H(p,q)
  \right]
  \right\}\\
&= \int_{qq'} \mathcal{D}q \, q(\bar{t}) 
  \exp \left\{
  i \int_t^{t'} d\tau\, \mathcal{L}(q,\dot{q})
  \right\}\, .
\end{align}

\subsection{Two-point function}
\label{sec:two-point-function}

Let us now consider the slightly more complicated case of the matrix
element of the product of two position operators
\begin{align}
  \label{eq:TwoPtDef}
  \bra{q't'} \hat{Q}_H(\bar{t}_1) \hat{Q}_H(\bar{t}_2)\ket{qt}\, , 
\end{align}
where now we assume $\bar{t}_1=t_{\bar k_1}$, $\bar{t}_2=t_{\bar k_2}$,
$t'>\bar{t}_1>\bar{t}_2>t$. We can write this correlator as:
\begin{align}
    \bra{q't'} \hat{Q}_H(\bar{t}_1) \hat{Q}_H(\bar{t}_2)\ket{qt} = 
  \bra{q'} \epsstep \dots \hat{Q} \ldots \hat{Q} \ldots \epsstep
  \ket{q}\, ,
\end{align}
where the three ellipses here denote respectively 
$(n-\bar k_1)$, $(\bar k_1-\bar k_2)$,
and $\bar k_2$ factors of $\epsstep$. Proceeding exactly as above yields: 
\begin{align}
  \label{eq:TwoPtPathInt}
  \bra{q't'} \hat{Q}_H(\bar{t}_1) \hat{Q}_H(\bar{t}_2)\ket{qt} = 
  \int_{qq'} \mathcal{D}q\, q(\bar{t}_1) q(\bar{t}_2) 
  \exp \left\{
  i \int_t^{t'} d\tau\, \mathcal{L}(q,\dot{q})
  \right\}\, .
\end{align}

There is a subtlety here that it is worth noting. The ordering of
times in \Eqref{eq:TwoPtDef} matters, while it clearly does not in the
RHS of \Eqref{eq:TwoPtPathInt} where $q(\bar{t}_1)$ and $q(\bar{t}_1)$
are just integration variables. If $\bar{t}_2>\bar{t}_1$, then the RHS
of \Eqref{eq:TwoPtPathInt} corresponds to
\begin{align}
  \bra{q't'} \hat{Q}_H(\bar{t}_2) \hat{Q}_H(\bar{t}_1) \ket{qt}\, .
\end{align}
Both results can be summarised as
\begin{align}
  \label{eq:TOrderPathInt}
  \bra{q't'} T\left(\hat{Q}_H(\bar{t}_1) \hat{Q}_H(\bar{t}_2)
  \right)\ket{qt} = 
  \int_{qq'} \mathcal{D}q\, q(\bar{t}_1) q(\bar{t}_2) 
  \exp \left\{
  i \int_t^{t'} d\tau\, \mathcal{L}(q,\dot{q})
  \right\}\, ,
\end{align}
where we have introduced the T-ordered product of operators: 
\begin{align}
  \label{eq:TOrderDef}
   T\left(\hat{Q}_H(t) \hat{Q}_H(t')\right) = \theta(t-t') \hat{Q}_H(t)
  \hat{Q}_H(t') + \theta(t'-t) \hat{Q}_H(t') \hat{Q}_H(t)\, .
\end{align}

You can easily verify that the derivation can be extended to
an arbitrary number of insertions of the operator $\hat{Q}$:
\begin{align}
\label{eq:TOrderNPt}
\bra{q't'} T\left(\hat{Q}_H(\bar{t}_1) \ldots \hat{Q}_H(\bar{t}_n)
  \right)\ket{qt} = 
  \int_{qq'} \mathcal{D}q\, q(\bar{t}_1) \ldots q(\bar{t}_n) 
  \exp \left\{
  i \int_t^{t'} d\tau\, \mathcal{L}(q,\dot{q})
  \right\}\, .
\end{align}

\subsection{Mixed Correlators}
\label{sec:MixedCorrelators}

Finally, we are going to consider mixed correlators of the form
\begin{align}
  \label{eq:MixedCorrOne}
  \bra{q't'} T\left(\hat{Q}_H(\bar{t}_1) \hat{P}_H(\bar{t}_2)\right)\ket{q,t}\, .
\end{align}
Clearly in this case we need to work in the full phase space, \ie\ keeping both the 
integrals over positions and momenta. 
Following the derivation in Sec.~\ref{sec:setting-up-path} and~\ref{sec:two-point-function}, 
we assume $\bar{t}_1=t_{\bar k_1}$, $\bar{t}_2=t_{\bar k_2}$, and split the time evolution 
into steps of size $\epsilon$, 
\begin{align}
  \bra{q't'} \hat{Q}_H(\bar{t}_1) \hat{P}_H(\bar{t}_2)\ket{qt} 
    &= \int \left(\prod_{k=1}^{n-1}dq_k\right)\,
      \bra{q'} \epsstep \ket{q_{n-1}} \dots \bra{q_{\bar k_1}}\hat{Q}\epsstep \ket{q_{\bar k_1 -1}} \ldots \times \nonumber \\
    & \quad \times \bra{q_{\bar k_2}}\hat{P}\epsstep \ket{q_{\bar{k}_2-1}} \ldots \bra{q_1}\epsstep \ket{q}\, .
\end{align}
Note that we have adopted the convention of including the operators $\hat{Q}$ and $\hat{P}$ to {\em the left}\ 
of the factor $\epsstep$ in the matrix elements above. This has consequences for the value of $q$ at which the 
Hamiltonian is evaluated, see below. With this convention, we can mimic the manipulations in the sections above, 
which yield Eq.~\eqref{eq:EpsStepBraKet}
\begin{align}
  \langle q_k | e^{-i\hat{H}\epsilon} | q_{k-1}\rangle = 
  \int \frac{dp_k}{2\pi}\, \exp\left\{i\epsilon \left[
  p_k \frac{q_k-q_{k-1}}{\epsilon} - H\left(p_k,\tilde{q}_k\right)
  \right]
  \right\} + O(\epsilon^2)\, ,
\end{align}
except for the two matrix elements with the operator insertions, 
\begin{align}
  \bra{q_{\bar k_1}}\hat{Q}\epsstep \ket{q_{\bar k_1 -1}} &= 
    \int \frac{dp_{\bar k_1}}{2\pi}\, q_{\bar k_1}\, \exp\left\{i\epsilon \left[
    p_{\bar k_1} \frac{q_{\bar k_1}-q_{\bar k_1-1}}{\epsilon} - H\left(p_{\bar k_1},\tilde{q}_{\bar k_1}\right)
    \right]
    \right\} + O(\epsilon^2)\, , \\
  \label{eq:SkipABeat}  
  \bra{q_{\bar k_2}}\hat{P}\epsstep \ket{q_{\bar{k}_2-1}} &=
    \int \frac{dp_{\bar k_2}}{2\pi}\, p_{\bar k_2}\, \exp\left\{i\epsilon \left[
    p_{\bar k_2} \frac{q_{\bar k_2}-q_{\bar k_2-1}}{\epsilon} - H\left(p_{\bar k_2},q_{\bar k_2-1}\right)
    \right]
    \right\} + O(\epsilon^2)\, .
\end{align}
As already mentioned above, the argument at which the Hamiltonian is evaluated in 
Eq.~\eqref{eq:SkipABeat} is $q_{\bar k_2-1}$ instead of $\tilde{q}_{\bar k_2}$. The 
difference between the two arguments is $O(\epsilon)$ and therefore irrelevant. 
Collecting all the terms, we obtain
\begin{align}
  \bra{q't'} T\left(\hat{Q}_H(\bar{t}_1) \hat{P}_H(\bar{t}_2)\right) \ket{qt} =& \lim_{n\to\infty} \int 
  \left(\prod_{k=1}^{n-1}dq_k\right)\, 
  \left(\prod_{j=1}^{n} \frac{dp_j}{2\pi}\right)\, q_{\bar k_1} p_{\bar k_2} \times \nonumber\\
  \label{eq:DiscretePhaseSpaceIntegralMixedCorr}
  &\quad \times \exp \left\{
    i\epsilon \sum_{m=1}^{n} \left[
    p_m \frac{q_m-q_{m-1}}{\epsilon} - H\left(p_m, 
    \tilde{q}_m \right)
    \right]
    \right\}\, ,
\end{align}
where $q_0 = q$, and $q_n = q'$.

\section{Canonical Commutation Relations}
\label{sec:CCR}
The expressions we found in the sections above must be consistent with the canonical 
commutation relation (CCR) between position and momentum, which we used implicitly 
when we wrote 
\begin{align}
  \braket{q}{p} = \exp \left(i q p \right)\, .
\end{align}
In order to check the CCR, we define the commutator of $\hat{Q}$ and $\hat{P}$ as
\begin{align}
  \label{eq:CCRDef}
  \bra{q't'} \left(\hat{Q}_H(t_{m+1}) \hat{P}_H(t_m) - \hat{P}_H(t_m) \hat{Q}_H(t_{m+1})\right) \ket{qt}\, .
\end{align}
With this definition, when we take the limit $\epsilon\to 0$, the operator are all evaluated at the same 
time, but the limit is reached with the correct ordering of the operators, 
\begin{align}
  \lim_{\epsilon\to 0} \hat{Q}_H(t_m+\epsilon) \hat{P}_H(t_m) = \hat{Q}_H(t_m) \hat{P}_H(t_m)\, , \\
  \lim_{\epsilon\to 0} \hat{P}_H(t_m) \hat{Q}_H(t_m-\epsilon) = \hat{P}_H(t_m) \hat{Q}_H(t_m)\, . 
\end{align}
With this convention we get for the CCR
\begin{align}
  \lim_{n\to\infty} & \int 
  \left(\prod_{k=1}^{n-1}dq_k\right)\, 
  \left(\prod_{j=1}^{n} \frac{dp_j}{2\pi}\right)\, p_{m} \left(q_{m+1}-q_{m-1}\right) \times \nonumber\\
  &\qquad\quad \times \exp \left\{
    i\epsilon \sum_{m=1}^{n} \left[
    p_m \frac{q_m-q_{m-1}}{\epsilon} - H\left(p_m, 
    \tilde{q}_m \right)
    \right]
    \right\} \\
  &= \int 
  \left(\prod_{k=1}^{n-1}dq_k\right)\, 
  \left(\prod_{j=1}^{n} \frac{dp_j}{2\pi}\right)\, 
  p_{m} \left[\left(q_{m+1}-q_{m}\right) + \left(q_{m}-q_{m-1}\right)\right] \times \nonumber\\
  & \qquad \quad \times \exp \left\{
    i\epsilon \sum_{m=1}^{n} \left[
    p_m \frac{q_m-q_{m-1}}{\epsilon} - H\left(p_m, 
    \tilde{q}_m \right)
    \right]
    \right\} \\ 
  &= \int 
  \left(\prod_{k=1}^{n-1}dq_k\right)\, 
  \left(\prod_{j=1}^{n} \frac{dp_j}{2\pi}\right)\, 
  p_{m} \left[-i \frac{\partial}{\partial p_{m+1}} -i \frac{\partial}{\partial p_{m}}\right] \times \nonumber\\
  & \qquad \quad \times \exp \left\{
      i\epsilon \sum_{m=1}^{n} \left[
      p_m \frac{q_m-q_{m-1}}{\epsilon} - H\left(p_m, 
      \tilde{q}_m \right)
      \right]
      \right\} + O(\epsilon) \\
  &= \int 
  \left(\prod_{k=1}^{n-1}dq_k\right)\, 
  \left(\prod_{j=1}^{n} \frac{dp_j}{2\pi}\right)\, 
  p_{m} \left[ 0 - i \right] \times \nonumber\\
  & \qquad \quad \times \exp \left\{
        i\epsilon \sum_{m=1}^{n} \left[
        p_m \frac{q_m-q_{m-1}}{\epsilon} - H\left(p_m, 
        \tilde{q}_m \right)
        \right]
        \right\} + O(\epsilon)\, ,
\end{align}
where in the last step we integrated by parts in $p_m$.

\section{Generating functional}
\label{sec:gener-funct}

\subsection{Functional derivative}
\label{sec:funct-deriv}

Consider a functional $F$ that associates a number, which we denote
$F[u]$, to a given function $u(x)$. The functional derivative
describes the change of the functional to an infinitesimal variation
of the function $u$: 
\[
  u(x) \mapsto u(x) + \delta u(x)\, .
\]
We define
\begin{equation}
  \label{eq:FuncDer}
  \delta F = F[u+\delta u] - F[u] = \int dx\, \frac{\delta F}{\delta
    u(x)} \delta u(x)\, .
\end{equation}
You can see the analogy to the case of a function of several
variables, where the variation to a change $\delta x_k$ in the
variables is given by
\begin{equation}
  \label{eq:NormDer}
  \delta F = F(x+\delta x) - F(x) = \sum_k \frac{\partial F}{\partial
    x_k} \delta x_k\, .
\end{equation}
In particular we have
\begin{equation}
  \label{eq:DiracDelta}
  \frac{\delta}{\delta f(x)} f(y) = \delta(x-y)\, , 
\end{equation}
again to be compared with its discrete analogue
\begin{equation}
  \label{eq:KroneckerDelta}
  \frac{\partial}{\partial x_j} x_i = \delta_{ij}\, .
\end{equation}

\subsection{Sources in the path integral}
\label{sec:sourc-path-integr}

Let $f(t)$ and $h(t)$ be two functions, we can add so-called source
terms to the path integral, and define
\begin{equation}
  \label{eq:PathIntegralSources}
  \braket{q't'}{qt}_{f,h} = \int \mathcal{D}p \mathcal{D}q\,\exp 
  \left\{
    i \int_{t}^{t'} d\tau \left[
      p(\tau) \dot{q}(\tau) - H(p(\tau),q(\tau)) + f(\tau) q(\tau) +
      h(\tau) p(\tau)
      \right]
  \right\}\, .
\end{equation}
Taking functional derivatives with respect to the source fields yields
e.g.
\begin{align}
  \left(\frac{1}{i} \frac{\delta}{\delta f(\bar\tau)} \right)&
  \braket{q't'}{qt}_{f,h} = \nonumber \\
  =&\int \mathcal{D}p \mathcal{D}q\,
  q(\bar{\tau})\,
  \exp \left\{
  i \int_{t}^{t'} d\tau \left[
  p(\tau) \dot{q}(\tau) - H(p(\tau),q(\tau)) + f(\tau) q(\tau) +
  h(\tau) p(\tau)
  \right]
  \right\}\, ,
\end{align}
\begin{align}
  \left(\frac{1}{i} \frac{\delta}{\delta f(\bar\tau_1)} \right)&
  \left(\frac{1}{i} \frac{\delta}{\delta f(\bar\tau_2)} \right)
  \braket{q't'}{qt}_{f,h} = \nonumber \\
  =&\int \mathcal{D}p \mathcal{D}q\,
  q(\bar{\tau}_1) q(\bar{\tau}_2)\,
  \exp \left\{
  i \int_{t}^{t'} d\tau \left[
  p(\tau) \dot{q}(\tau) - H(p(\tau),q(\tau)) + f(\tau) q(\tau) +
  h(\tau) p(\tau)
  \right]
  \right\}\, , 
\end{align}
and similarly for the derivatives with respect to $h$ pulling down
factors of $p$ in the integrand. 

As we have seen in the previous section, we have
\begin{align}
  \bra{q't'}  T\left(
  \hat{Q}(t_1)\ldots \hat{Q}(t_n) 
  \right)
  \ket{qt} =& \nonumber \\
  =& \left(\frac{1}{i} \frac{\delta}{\delta f(t_1)} \right) \ldots
    \left(\frac{1}{i} \frac{\delta}{\delta f(t_n)} \right)\,
    \braket{q't'}{qt}_{f,h}\Bigg|_{f=h=0}\, .
\end{align}

\section{Projection onto the ground state}
\label{sec:proj-onto-ground}

It is useful to be able to compute the amplitude for the system to
evolve from the vacuum state at time $t$ into the vacuum state at time
$t'$ under the action of the external sources $f,h$. Having computed
$\braket{q't'}{qt}$, the above amplitude is given by
\begin{align}
  \label{eq:VacToVacAmpl}
  \braket{0,t'}{0,t} = 
  \int dq dq'\, \phi_0(q')^*\, \braket{q't'}{qt}_{f,h}\, \phi_0(q)\, ,
\end{align}
where $\phi_0(q)=\braket{q}{0}$ is the wave function of the ground
state, and $\ket{n}$ denote the eigenstates of the
Hamiltonian. \Eqref{eq:VacToVacAmpl} yields the right amplitude, but
requires the convolution of $\braket{q't'}{qt}$ with the ground state
wave function. We shall now describe a procedure that allows the
compute the vacuum-to-vacuum amplitude directly as a path integral. 

The energy eigenstates are
\begin{equation}
  \label{eq:EnEigen}
  \hat{H} \ket{n} = E_n \ket{n}\, ,
\end{equation}
and their wave functions are denoted as
\begin{equation}
  \label{eq:EnEigenFun}
  \phi_n(q) = \braket{q}{n}\, .
\end{equation}
We assume that the vacuum energy vanishes, $E_0=0$. We want to
evaluate the amplitude
\begin{equation}
  \label{eq:LargeQAmpl}
  \braket{Q'T'}{QT}_{f,h}
\end{equation}
where the sources $h$ and $f$ have support in the interval $[t,t']$,
with $T < t < t' < T'$. The sources being switched off between $T$
and $t$, we can readily compute
\begin{align}
  \braket{qt}{QT} &= \int \mathcal{D}q \mathcal{D}p \,
                    \exp\left\{
                    i \int_T^t d\tau\, \left[
                    p \dot{q} - H(p,q)
                    \right]
                    \right\} \\
  &= \bra{q} \exp\left[-i \hat{H} (t-T)\right] \ket{Q} \\
  &= \sum_n \phi_n(q) \phi_n(Q)^* e^{-i E_n(t-T)}\, .
\end{align}
We can now analytically continue the result to $T_I=(1-i\epsilon)T$,
and consider the limit $T\to -\infty$:
\begin{align}
  \lim_{T\to -\infty} \braket{qt}{QT_I} = \phi_0(q) \phi_0(Q)^*\, .
\end{align}
A similar result can be obtained for $\braket{Q'T'}{q't'}$. We can
therefore write
\begin{align}
  \braket{Q'T'}{QT}_{f,h} = \int dq' dq\, \braket{Q'T'}{q't'} \braket{q't'}{qt}_{f,h}
  \braket{qt}{QT}\, ,
\end{align}
and hence
\begin{align}
 \lim_{T'\to\infty,T\to -\infty} 
\frac{\braket{Q', (1-i\epsilon)T'}{Q, (1-i\epsilon)T}_{f,h}}{\phi_0(Q)^* \phi_0(Q')} = 
  \int dq dq'\, \phi_0(q')^* \braket{q't'}{qt}_{f,h} \phi_0(q)\, .
\end{align}
The expresson on the RHS is the vacuum-to-vacuum amplitude,
$\braket{0,t'}{0,t}_{f,h}$, that we want to compute. The expression on
the LHS is the limit of the path integral for $T\to\infty$,
$T'\to\infty$. The only dependence on the boundary values $Q$ and $Q'$
appears in the denominator on LHS: it is a normalization factor
independent of $f$ and $h$, which disappears when taking derivatives
with respect to the sources. Instead of analytically continuing to
complex values of $T$ and $T'$, we can simply add an imaginary part to
the Hamiltonian,
\begin{equation}
  \label{eq:ComplexTermHam}
  \hat{H} \to (1-i\epsilon) \hat{H}\, .
\end{equation}
Taking the limit $T\to\infty$, $T'\to\infty$, we obtain the amplitude
\begin{equation}
  \label{eq:VacToVac}
  \braket{0}{0}_{f,h} = \int \mathcal{D}p \mathcal{D}q \, \exp
  \left\{
    i \int_{-\infty}^\infty d\tau\, \Big[
      p \dot{q} - (1-i\epsilon) H(p,q) + f q + h p 
      \Big]
  \right\}
\end{equation}


\section{Weyl ordering}
\label{sec:weyl-ordering}

If we are interested in more general Hamiltonians, with terms that
involve products of $\hat{P}$ and $\hat{Q}$, then we need to give a
prescription for the ordering of the operators in the Hamiltonian, so
that the quantum mechanical amplitude is actually described by the
path integral. 

As discussed by Berezin in 1971, the mid-point prescription we adopted
in \Eqref{eq:PathIntDefOne} is equivalent to the Weyl-ordering of the
Hamiltonian. 

The Weyl product of two operators $\hat{A}$ and $\hat{B}$ is defined
by considering the operator $\left(\alpha \hat{A} + \beta
  \hat{B}\right)^n$, and expanding it in powers of $\alpha$ and $\beta$: 
\begin{equation}
  \label{eq:WeylOrder}
  \left(\alpha \hat{A} + \beta
    \hat{B}\right)^n = \sum_k \frac{n!}{k! l!}\, 
  \alpha^k \beta^l\, \left[\hat{A}^k
    \hat{B}^l\right]\, .
\end{equation}
The quantity in the square bracket is the Weyl ordered product of
$\hat{A}^k$ and $\hat{B}^l$. 

